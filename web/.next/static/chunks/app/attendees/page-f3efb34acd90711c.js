(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[785],{7983:function(e,t,n){Promise.resolve().then(n.bind(n,8643))},8643:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var c=n(7437),s=n(7138),r=n(2265),a=n(1013);function o(e){let{initialRows:t}=e,[n,o]=(0,r.useState)(t||[]),[i,l]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{if(!i.trim()){f(""),e||o(t||[]);return}u(!0),f("");let n=await a.h.listContacts({search:i,limit:50,offset:0});e||o(n)}catch(t){e||f((null==t?void 0:t.message)||"Failed to load")}finally{e||u(!1)}})(),()=>{e=!0}},[i,t]);let m=(0,r.useMemo)(()=>n,[n]);return(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsx)("div",{className:"flex items-end gap-2",children:(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Search"}),(0,c.jsx)("input",{value:i,onChange:e=>l(e.target.value),placeholder:"Name, email, phone…",className:"w-full px-3 py-2 border rounded text-sm bg-white dark:bg-gray-900"})]})}),d&&(0,c.jsx)("div",{className:"text-sm text-gray-500",children:"Loading…"}),h&&(0,c.jsx)("div",{className:"text-sm text-red-600",children:h}),(0,c.jsx)("div",{className:"border rounded",children:(0,c.jsxs)("table",{className:"w-full text-sm",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"text-left border-b",children:[(0,c.jsx)("th",{className:"p-2",children:"Name"}),(0,c.jsx)("th",{className:"p-2",children:"Email"}),(0,c.jsx)("th",{className:"p-2",children:"Counts"}),(0,c.jsx)("th",{className:"p-2",children:"Last activity"})]})}),(0,c.jsxs)("tbody",{children:[m.map(e=>(0,c.jsxs)("tr",{className:"border-b last:border-b-0 hover:bg-gray-50 dark:hover:bg-gray-800/40",children:[(0,c.jsx)("td",{className:"p-2 whitespace-nowrap",children:(0,c.jsx)(s.default,{href:"/attendees/".concat(e.id,"/overview"),className:"underline underline-offset-2",children:[e.first_name,e.last_name].filter(Boolean).join(" ")||"—"})}),(0,c.jsx)("td",{className:"p-2 whitespace-nowrap",children:e.email||"—"}),(0,c.jsxs)("td",{className:"p-2",children:[(0,c.jsxs)("span",{className:"inline-flex items-center gap-1 mr-3",children:[e.events_purchased||0," evts"]}),(0,c.jsxs)("span",{className:"inline-flex items-center gap-1",children:[e.tickets_held||0," tix"]})]}),(0,c.jsx)("td",{className:"p-2 text-xs text-gray-600 dark:text-gray-400",children:e.last_activity?new Date(e.last_activity).toLocaleString():"—"})]},e.id)),0===m.length&&(0,c.jsx)("tr",{children:(0,c.jsx)("td",{className:"p-4 text-gray-500",colSpan:4,children:"No attendees found."})})]})]})})]})}},357:function(e,t,n){"use strict";var c,s;e.exports=(null==(c=n.g.process)?void 0:c.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(8081)},8081:function(e){!function(){var t={229:function(e){var t,n,c,s=e.exports={};function r(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var i=[],l=!1,d=-1;function u(){l&&c&&(l=!1,c.length?i=c.concat(i):d=-1,i.length&&h())}function h(){if(!l){var e=o(u);l=!0;for(var t=i.length;t;){for(c=i,i=[];++d<t;)c&&c[d].run();d=-1,t=i.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.push(new f(e,t)),1!==i.length||l||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function c(e){var s=n[e];if(void 0!==s)return s.exports;var r=n[e]={exports:{}},a=!0;try{t[e](r,r.exports,c),a=!1}finally{a&&delete n[e]}return r.exports}c.ab="//";var s=c(229);e.exports=s}()},1013:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var c=n(357);let s="/api",r=c.env.NEXT_PUBLIC_API_TOKEN;async function a(e,t){let n={"Content-Type":"application/json",...(null==t?void 0:t.headers)||{}};r&&(n["X-Auth-Token"]=r);let c=await fetch("".concat(s).concat(e),{headers:n,...t,cache:"no-store"});if(!c.ok){let e="".concat(c.status," ").concat(c.statusText);try{let t=await c.json();(null==t?void 0:t.detail)&&(e=Array.isArray(t.detail)?t.detail.map(e=>e.msg||e).join(", "):t.detail)}catch(e){}throw Error(e)}if(204!==c.status)return c.json()}c.env.BACKEND_ORIGIN;let o={listEvents:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a("/events?limit=".concat(e,"&offset=").concat(t))},resolveEvent:e=>a("/events/public/".concat(encodeURIComponent(e))),getEvent:e=>a("/events/".concat(e)),createEvent:e=>a("/events",{method:"POST",body:JSON.stringify(e)}),updateEvent:(e,t)=>a("/events/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),listTicketTypes:e=>a("/events/".concat(e,"/ticket_types")),createTicketType:(e,t)=>a("/events/".concat(e,"/ticket_types"),{method:"POST",body:JSON.stringify(t)}),updateTicketType:(e,t)=>a("/events/ticket_types/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),reconciliation:e=>a("/reports/reconciliation?event_id=".concat(e)),listEventPurchases:e=>a("/events/".concat(e,"/purchases")),listAttendees:e=>a("/events/".concat(e,"/attendees")),getPurchase:e=>a("/purchases/".concat(e)),getPurchaseByGuid:e=>a("/purchases/by-guid/".concat(encodeURIComponent(e))),payPurchase:e=>a("/purchases/".concat(e,"/pay"),{method:"POST"}),resendPurchasePayment:e=>a("/purchases/".concat(e,"/resend_payment"),{method:"POST"}),listContacts:e=>{let t=new URLSearchParams;(null==e?void 0:e.search)&&t.set("search",e.search),(null==e?void 0:e.roles)&&t.set("roles",e.roles),(null==e?void 0:e.limit)!=null&&t.set("limit",String(e.limit)),(null==e?void 0:e.offset)!=null&&t.set("offset",String(e.offset));let n=t.toString()?"?".concat(t.toString()):"";return a("/contacts".concat(n))},getContact:e=>a("/contacts/".concat(e)),listContactPurchases:(e,t)=>a("/contacts/".concat(e,"/purchases").concat(t?"?event_id=".concat(t):"")),listHolderTickets:e=>a("/contacts/".concat(e,"/holder_tickets")),ticketByCode:e=>a("/tickets/by-code/".concat(encodeURIComponent(e))),ticketByToken:e=>a("/tickets/by-token/".concat(encodeURIComponent(e))),payByToken:e=>a("/tickets/pay",{method:"POST",body:JSON.stringify({token:e})}),lookupTicket:(e,t)=>a("/tickets/lookup?code=".concat(encodeURIComponent(e)).concat(t?"&event_id=".concat(t):"")),checkin:(e,t)=>a("/checkin",{method:"POST",body:JSON.stringify({event_id:e,code:t})}),listEmailLogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a("/admin/email_logs?limit=".concat(e,"&offset=").concat(t))},sendTestEmail:e=>a("/test_email?to=".concat(encodeURIComponent(e)),{method:"POST"}),qrUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"".concat(s,"/qr?data=").concat(encodeURIComponent(e),"&scale=").concat(t)}}}},function(e){e.O(0,[138,971,23,744],function(){return e(e.s=7983)}),_N_E=e.O()}]);